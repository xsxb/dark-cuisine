[gd_scene load_steps=20 format=3 uid="uid://co0n2vsrb61it"]

[ext_resource type="Script" path="res://room/room.gd" id="1_aaa8y"]
[ext_resource type="Texture2D" uid="uid://dfd7nd22i1xi1" path="res://assets/art/Lab/Full 01.png" id="2_1rc6e"]
[ext_resource type="Texture2D" uid="uid://dniidnnaua8s" path="res://assets/art/Placeholder/cauldron-placeholder.png" id="3_luik3"]
[ext_resource type="Theme" uid="uid://lwhy6nphe0ya" path="res://ui/base_theme.tres" id="4_p5ch1"]
[ext_resource type="Script" path="res://room/InventoryManagement.gd" id="5_1bptw"]
[ext_resource type="Script" path="res://cauldron_menu.gd" id="5_rrmvn"]
[ext_resource type="Script" path="res://ui/CauldronInventory.gd" id="7_3hvn4"]
[ext_resource type="PackedScene" uid="uid://ch0lbubw47vx4" path="res://ui/inventory.tscn" id="7_8x0ij"]
[ext_resource type="AudioStream" uid="uid://cliyahuujicxy" path="res://assets/sfx/blubber-loop.mp3" id="8_3ggf8"]
[ext_resource type="Script" path="res://CauldronScriptNode.gd" id="8_4jpey"]
[ext_resource type="Script" path="res://ui/PlayerInventory.gd" id="8_feovw"]
[ext_resource type="AudioStream" uid="uid://bgcrkr17w5k60" path="res://assets/music/lab_beat01.mp3" id="11_urlu4"]
[ext_resource type="PackedScene" uid="uid://c32o5n4thngoo" path="res://spawned_monster.tscn" id="12_6xdus"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_pvofs"]

[sub_resource type="Theme" id="Theme_klli4"]
Panel/styles/panel = SubResource("StyleBoxFlat_pvofs")

[sub_resource type="GDScript" id="GDScript_jn38e"]
script/source = "extends Control

@export var animation_player : AnimationPlayer


# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	pass


func _on_minimize_button_toggled(toggled_on):
	if toggled_on:
		animation_player.play(\"minimize\")
	if !toggled_on:
		animation_player.play_backwards(\"minimize\")
"

[sub_resource type="Animation" id="Animation_7sqqv"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(257, 540)]
}

[sub_resource type="Animation" id="Animation_kyf1q"]
resource_name = "minimize"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(257, 540), Vector2(257, 641)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_fmit7"]
_data = {
"RESET": SubResource("Animation_7sqqv"),
"minimize": SubResource("Animation_kyf1q")
}

[node name="Room" type="Node2D" node_paths=PackedStringArray("cauldron_button")]
script = ExtResource("1_aaa8y")
cauldron_button = NodePath("CauldronMenu/CauldronButton")

[node name="Background" type="Sprite2D" parent="."]
scale = Vector2(0.46, 0.46)
texture = ExtResource("2_1rc6e")
centered = false

[node name="CursorItemSprite" type="Sprite2D" parent="."]
visible = false
top_level = true
centered = false

[node name="CauldronMenu" type="Control" parent="." node_paths=PackedStringArray("script_node", "background_panel")]
layout_mode = 3
anchors_preset = 0
offset_left = 405.0
offset_top = 158.0
offset_right = 405.0
offset_bottom = 158.0
theme = ExtResource("4_p5ch1")
script = ExtResource("5_rrmvn")
script_node = NodePath("CauldronScriptNode")
background_panel = NodePath("BackgroundPanel")
metadata/_edit_use_anchors_ = true

[node name="CauldronButton" type="TextureButton" parent="CauldronMenu"]
layout_mode = 0
offset_left = -63.0
offset_top = 294.0
offset_right = 60.0
offset_bottom = 376.0
texture_normal = ExtResource("3_luik3")
ignore_texture_size = true
stretch_mode = 0
metadata/_edit_use_anchors_ = true

[node name="BackgroundPanel" type="Panel" parent="CauldronMenu"]
layout_mode = 0
offset_right = 441.0
offset_bottom = 331.0

[node name="CauldronInventory" parent="CauldronMenu/BackgroundPanel" node_paths=PackedStringArray("inventory_management") instance=ExtResource("7_8x0ij")]
layout_mode = 1
offset_left = 44.0
offset_top = 44.0
offset_right = 44.0
offset_bottom = 44.0
theme = SubResource("Theme_klli4")
script = ExtResource("7_3hvn4")
inv_id = 2
columns = 3
rows = 3
inventory_management = NodePath("../../../InventoryManagement")

[node name="Timer" type="Timer" parent="CauldronMenu/BackgroundPanel/CauldronInventory"]
wait_time = 0.1
one_shot = true
autostart = true

[node name="VBoxContainer" type="VBoxContainer" parent="CauldronMenu/BackgroundPanel"]
layout_mode = 0
offset_left = 320.0
offset_top = 104.0
offset_right = 410.0
offset_bottom = 170.0

[node name="CookButton" type="Button" parent="CauldronMenu/BackgroundPanel/VBoxContainer"]
layout_mode = 2
theme = ExtResource("4_p5ch1")
text = "Cook"

[node name="ClearButton" type="Button" parent="CauldronMenu/BackgroundPanel/VBoxContainer"]
layout_mode = 2
theme = ExtResource("4_p5ch1")
text = "Clear"

[node name="ExitButton" type="Button" parent="CauldronMenu/BackgroundPanel"]
layout_mode = 0
offset_right = 11.0
offset_bottom = 17.0
rotation = 0.0343104
text = "X"

[node name="CauldronScriptNode" type="Node" parent="CauldronMenu" node_paths=PackedStringArray("inventory", "player_inventory")]
script = ExtResource("8_4jpey")
inventory = NodePath("../BackgroundPanel/CauldronInventory")
player_inventory = NodePath("../../PlayerInventoryMenu/PlayerInventory")

[node name="PlayerInventoryMenu" type="Control" parent="." node_paths=PackedStringArray("animation_player")]
layout_mode = 3
anchors_preset = 0
offset_left = 257.0
offset_top = 540.0
offset_right = 857.0
offset_bottom = 660.0
script = SubResource("GDScript_jn38e")
animation_player = NodePath("MenuAnimation")
metadata/_edit_use_anchors_ = true

[node name="MinimizeButton" type="Button" parent="PlayerInventoryMenu"]
layout_mode = 0
offset_left = 261.0
offset_top = -32.0
offset_right = 340.0
offset_bottom = -1.0
toggle_mode = true
text = "Minimize"
metadata/_edit_use_anchors_ = true

[node name="Panel" type="Panel" parent="PlayerInventoryMenu"]
layout_mode = 0
offset_right = 600.0
offset_bottom = 120.0
metadata/_edit_use_anchors_ = true

[node name="PlayerInventory" parent="PlayerInventoryMenu" node_paths=PackedStringArray("inventory_management") instance=ExtResource("7_8x0ij")]
layout_mode = 1
script = ExtResource("8_feovw")
inv_id = 1
inventory_management = NodePath("../../InventoryManagement")
metadata/_edit_use_anchors_ = true

[node name="MenuAnimation" type="AnimationPlayer" parent="PlayerInventoryMenu"]
libraries = {
"": SubResource("AnimationLibrary_fmit7")
}
speed_scale = 4.0

[node name="BlubberLoopAudioStream" type="AudioStreamPlayer" parent="."]
stream = ExtResource("8_3ggf8")
volume_db = -24.674
pitch_scale = 0.61
autoplay = true

[node name="MusicAudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource("11_urlu4")
volume_db = -12.018
autoplay = true

[node name="InventoryManagement" type="Node" parent="." node_paths=PackedStringArray("picked_up_sprite")]
script = ExtResource("5_1bptw")
picked_up_sprite = NodePath("../CursorItemSprite")

[node name="TestMonster" parent="." instance=ExtResource("12_6xdus")]
position = Vector2(519, 445)

[connection signal="child_entered_tree" from="." to="InventoryManagement" method="_on_room_child_entered_tree"]
[connection signal="pressed" from="CauldronMenu/CauldronButton" to="CauldronMenu" method="_on_cauldron_button_pressed"]
[connection signal="timeout" from="CauldronMenu/BackgroundPanel/CauldronInventory/Timer" to="CauldronMenu/BackgroundPanel/CauldronInventory" method="_on_timer_timeout"]
[connection signal="pressed" from="CauldronMenu/BackgroundPanel/VBoxContainer/CookButton" to="CauldronMenu/CauldronScriptNode" method="_on_cook_button_pressed"]
[connection signal="pressed" from="CauldronMenu/BackgroundPanel/ExitButton" to="CauldronMenu" method="_on_exit_button_pressed"]
[connection signal="toggled" from="PlayerInventoryMenu/MinimizeButton" to="PlayerInventoryMenu" method="_on_minimize_button_toggled"]
[connection signal="ready" from="InventoryManagement" to="CauldronMenu/BackgroundPanel/CauldronInventory" method="_on_inventory_management_ready"]
[connection signal="ready" from="InventoryManagement" to="PlayerInventoryMenu/PlayerInventory" method="_on_inventory_management_ready"]
